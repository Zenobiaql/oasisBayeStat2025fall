% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/l2_wrappers.R
\name{oasis_ar1}
\alias{oasis_ar1}
\title{OASIS AR(1) Deconvolution (Core Algorithm)}
\usage{
oasis_ar1(y, g, lam = 0, s_min = 0)
}
\arguments{
\item{y}{Numeric vector. Fluorescence trace.}

\item{g}{Numeric scalar. Decay factor. Must be in [0, 1).}

\item{lam}{Numeric scalar. Sparsity penalty.}

\item{s_min}{Numeric scalar. Minimum spike size.}
}
\value{
A list containing:
\itemize{
  \item \code{c}: Denoised calcium trace.
  \item \code{s}: Deconvolved spike train.
}
}
\description{
A low-level wrapper for the OASIS deconvolution algorithm.
}
\examples{
# 1. Simulate data
dat <- generate_data(N = 1, g = 0.95, sn = 0.3, seed = 42)
y <- dat$Y

# 2. Step-by-step Parameter Estimation (Manual Pipeline)
#    A. Estimate noise
sn_est <- GetSn(y)
#    B. Estimate decay (using estimated noise)
g_est <- GetDecay(y, sn = sn_est)
#    C. Set sparsity penalty (heuristic)
lam_est <- 2 * sn_est

# 3. Run Core Deconvolution
#    Note: 'g' is mandatory here!
fit <- oasis_ar1(y, g = g_est, lam = lam_est)

# 4. Inspect results (fit is a raw list here, not an S3 object)

cat("Number of spikes detected:", sum(fit$s > 0), "\n")
cat("Max calcium value:", max(fit$c), "\n")

# 5. Compare with Ground Truth
cor_c <- cor(fit$c, dat$c)
cat(sprintf("Correlation with truth: \%.4f\n", cor_c))

}

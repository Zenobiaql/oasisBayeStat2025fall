% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/l2_wrappers.R
\name{GetDecay}
\alias{GetDecay}
\title{Estimate AR(1) Decay Factor (Bias Corrected)}
\usage{
GetDecay(y, sn = NULL)
}
\arguments{
\item{y}{Numeric vector. The observed fluorescence trace.}

\item{sn}{Numeric scalar. The noise standard deviation.
If \code{NULL} (default), 
it will be estimated automatically using \code{GetSn(y)}.}
}
\value{
A numeric scalar (estimated g).
}
\description{
Estimates the decay factor 'g' using autocorrelation, corrected for
noise variance to avoid underestimation.
}
\examples{
# 1. Simulate data with known decay (g = 0.95)
dat <- generate_data(N = 1, g = 0.95, seed = 123)
y <- dat$Y

# 2. Estimate decay (automatically estimates sn internally)
g_auto <- GetDecay(y)

# 3. Estimate decay with explicit noise (recommended if sn is known)
#    This avoids re-calculating sn and allows for manual tuning
sn_known <- 0.3
g_explicit <- GetDecay(y, sn = sn_known)

cat(sprintf("True g: 0.95, Est (Auto): \%.4f, Est (Explicit): \%.4f\n", 
            g_auto, g_explicit))

}
